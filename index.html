<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unknown Dubbers - Premium Anime Streaming</title>
    <link rel="stylesheet" href="styles.css">
    
    <!-- Monetag Service Worker Registration -->
    <script>
        (function() {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/sw.js', { scope: '/' })
                    .then(function(registration) {
                        console.log('Monetag SW registered');
                    })
                    .catch(function(error) {
                        console.log('SW registration failed:', error);
                    });
            }
        })();
    </script>
    
    <style>
        .hamburger-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 6px;
            cursor: pointer;
            z-index: 1001;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            transition: all 0.3s;
        }
        .hamburger-btn:hover { transform: scale(1.1); }
        .hamburger-line {
            width: 25px;
            height: 3px;
            background: white;
            border-radius: 3px;
            transition: all 0.3s;
        }
        .hamburger-btn.active .hamburger-line:nth-child(1) {
            transform: rotate(45deg) translateY(9px);
        }
        .hamburger-btn.active .hamburger-line:nth-child(2) {
            opacity: 0;
        }
        .hamburger-btn.active .hamburger-line:nth-child(3) {
            transform: rotate(-45deg) translateY(-9px);
        }
        .drawer-menu {
            position: fixed;
            top: 0;
            right: -300px;
            width: 300px;
            height: 100vh;
            background: white;
            box-shadow: -5px 0 25px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            transition: right 0.3s ease;
            padding: 80px 20px 20px;
        }
        .drawer-menu.open { right: 0; }
        .drawer-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        .drawer-overlay.open {
            opacity: 1;
            pointer-events: all;
        }
        .drawer-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 18px 20px;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            border-radius: 12px;
            text-decoration: none;
            color: #1e293b;
            font-weight: 600;
            font-size: 16px;
            transition: all 0.3s;
        }
        .drawer-item:hover {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            transform: translateX(-5px);
        }
        .drawer-icon { font-size: 24px; }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="site-branding">
                <img src="https://image2url.com/r2/default/images/1769863844681-7b707f24-5692-47c3-b3f2-8a87684f4862.jpg" alt="Unknown Dubbers Logo" class="site-logo">
                <div class="brand-text">
                    <h1>UNKNOWN DUBBERS</h1>
                    <p class="tagline">Your Premium Anime Destination</p>
                </div>
            </div>
        </div>
    </header>

    <div class="hamburger-btn" onclick="toggleMenu()">
        <div class="hamburger-line"></div>
        <div class="hamburger-line"></div>
        <div class="hamburger-line"></div>
    </div>

    <div class="drawer-overlay" onclick="toggleMenu()"></div>

    <div class="drawer-menu">
        <a href="index.html" class="drawer-item">
            <span class="drawer-icon">üè†</span>
            <span>Home</span>
        </a>
        <a href="membership.html" class="drawer-item">
            <span class="drawer-icon">üëë</span>
            <span>Membership</span>
        </a>
        <a href="admin.html" class="drawer-item">
            <span class="drawer-icon">‚öôÔ∏è</span>
            <span>Admin Panel</span>
        </a>
    </div>

    <main class="container">
        <section class="hero-banner">
            <div class="hero-content">
                <div class="hero-badge">
                    <span>‚≠ê</span>
                    <span>Premium Anime Streaming</span>
                </div>
                <h2 class="hero-title">Watch Your Favorite Anime</h2>
                <p class="hero-subtitle">Stream thousands of episodes in HD quality. New episodes added daily.</p>
            </div>
        </section>

        <section class="search-section">
            <h3 class="section-title">üîç Search Anime</h3>
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Search for your favorite anime..." />
                <button id="searchBtn">Search ‚Üí</button>
            </div>
        </section>

        <section id="searchResults" class="hidden">
            <h2>üîç Search Results</h2>
            <div id="searchGrid" class="anime-grid"></div>
        </section>

        <section class="popular-section">
            <h2>üî• Trending Now</h2>
            <div id="popularGrid" class="anime-grid">
                <p class="loading">Loading anime...</p>
            </div>
        </section>
    </main>

    <footer class="site-footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <img src="https://image2url.com/r2/default/images/1769863844681-7b707f24-5692-47c3-b3f2-8a87684f4862.jpg" alt="Logo" class="footer-logo">
                    <h3>UNKNOWN DUBBERS</h3>
                    <p>Your premium anime streaming destination</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 Unknown Dubbers. All rights reserved.</p>
                <p>Made with ‚ù§Ô∏è for anime fans</p>
            </div>
        </div>
    </footer>

    <script>
        function toggleMenu() {
            const hamburger = document.querySelector('.hamburger-btn');
            const drawer = document.querySelector('.drawer-menu');
            const overlay = document.querySelector('.drawer-overlay');
            
            hamburger.classList.toggle('active');
            drawer.classList.toggle('open');
            overlay.classList.toggle('open');
        }
    </script>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, get } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

        const firebaseConfig = {
            apiKey: "AIzaSyDPwwCP2aLK7R22BNUq-rMtOVLs3Zn6xTs",
            authDomain: "unknown-dubbers.firebaseapp.com",
            databaseURL: "https://unknown-dubbers-default-rtdb.firebaseio.com",
            projectId: "unknown-dubbers",
            storageBucket: "unknown-dubbers.firebasestorage.app",
            messagingSenderId: "293718979131",
            appId: "1:293718979131:web:00e0e7efe5127e7b46621e"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        window.addEventListener('DOMContentLoaded', loadPopularAnime);

        async function loadPopularAnime() {
            try {
                const snapshot = await get(ref(database, 'anime'));
                if (snapshot.exists()) {
                    displayAnime(snapshot.val(), 'popularGrid');
                } else {
                    document.getElementById('popularGrid').innerHTML = '<p class="no-results">No anime available.</p>';
                }
            } catch (error) {
                console.error('Error:', error);
            }
        }

        function displayAnime(animeData, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            const animeArray = Object.entries(animeData).map(([id, data]) => ({id, ...data}));

            animeArray.forEach(anime => {
                const card = document.createElement('div');
                card.className = 'anime-card';
                card.innerHTML = `
                    <img src="${anime.poster}" alt="${anime.name}">
                    <h3>${anime.name}</h3>
                `;
                card.onclick = () => window.location.href = `anime.html?id=${anime.id}`;
                container.appendChild(card);
            });
        }

        document.getElementById('searchBtn').addEventListener('click', performSearch);
        document.getElementById('searchInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') performSearch();
        });

        async function performSearch() {
            const searchTerm = document.getElementById('searchInput').value.trim().toLowerCase();
            if (!searchTerm) return alert('Please enter a search term');

            try {
                const snapshot = await get(ref(database, 'anime'));
                if (snapshot.exists()) {
                    const filtered = Object.entries(snapshot.val())
                        .filter(([id, anime]) => anime.name.toLowerCase().includes(searchTerm))
                        .reduce((obj, [id, data]) => { obj[id] = data; return obj; }, {});

                    document.getElementById('searchResults').classList.remove('hidden');
                    displayAnime(filtered, 'searchGrid');
                }
            } catch (error) {
                console.error('Error:', error);
            }
        }
    </script>
</body>
</html>
